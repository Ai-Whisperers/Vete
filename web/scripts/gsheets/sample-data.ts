/**
 * Google Sheets Sample Data
 * Populates the spreadsheet with data from JSON seed files
 */

import { updateValues, batchUpdateValues } from './auth'
import { SPREADSHEET_ID } from './config'
import { loadCategories, loadBrands, loadSuppliers, loadProducts } from './json-data'

/**
 * Comprehensive guide content - Horizontal multi-column layout
 */
function getGuideContent(): string[][] {
  return [
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // HEADER SECTION
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ['ğŸ¥ PLANTILLA DE INVENTARIO VETERINARIO', '', '', '', '', '', '', ''],
    [
      'Sistema Integral de GestiÃ³n de Inventario para ClÃ­nicas Veterinarias',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // Critical warning
    [
      'âš ï¸ IMPORTANTE: Antes de comenzar, ve a Archivo â†’ Hacer una copia. Trabaja SOLO en tu copia personal. NO edites esta plantilla original.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SECTION 1: INTRODUCTION
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['ğŸ“‹ 1. Â¿QUÃ‰ ES ESTA PLANTILLA?', '', '', '', '', '', '', ''],
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],
    [
      'Esta plantilla te permite gestionar TODO el inventario de tu clÃ­nica veterinaria desde Google Sheets.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'Los datos que ingreses aquÃ­ se sincronizan con tu sistema web, permitiÃ©ndote:',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],
    [
      '  âœ… Carga masiva de productos (importar cientos de productos de una vez)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      '  âœ… ActualizaciÃ³n de precios en lote (cambiar precios de mÃºltiples productos)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['  âœ… Control de stock con trazabilidad por lotes y vencimientos', '', '', '', '', '', '', ''],
    ['  âœ… GestiÃ³n de proveedores y marcas', '', '', '', '', '', '', ''],
    ['  âœ… Reportes automÃ¡ticos de inventario valorizado', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', ''],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SECTION 2: GETTING STARTED
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['ğŸš€ 2. CÃ“MO EMPEZAR (PASO A PASO)', '', '', '', '', '', '', ''],
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],
    ['PASO 1ï¸âƒ£  Hacer una copia personal', '', '', '', '', '', '', ''],
    [
      '           â†’ Archivo â†’ Hacer una copia â†’ Guardar en tu Google Drive',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      '           â†’ Trabaja SIEMPRE en tu copia, nunca en la plantilla original',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],
    ['PASO 2ï¸âƒ£  Revisar la configuraciÃ³n', '', '', '', '', '', '', ''],
    ['           â†’ Ve a la hoja âš™ï¸ ConfiguraciÃ³n', '', '', '', '', '', '', ''],
    [
      '           â†’ Verifica las ubicaciones de stock (DepÃ³sito, ExhibiciÃ³n, Farmacia, etc.)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['           â†’ Ajusta los responsables autorizados', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', ''],
    ['PASO 3ï¸âƒ£  Explorar el catÃ¡logo existente', '', '', '', '', '', '', ''],
    [
      '           â†’ ğŸ“‚ CategorÃ­as: Revisa la estructura de categorÃ­as disponibles',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      '           â†’ ğŸ·ï¸ Marcas: MÃ¡s de 100 marcas veterinarias ya cargadas',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      '           â†’ ğŸ†• Productos: CatÃ¡logo con +2000 productos listos para usar',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],
    ['PASO 4ï¸âƒ£  Agregar TUS productos a "Mis Productos"', '', '', '', '', '', '', ''],
    ['           â†’ Ve a ğŸ“‹ Mis Productos', '', '', '', '', '', '', ''],
    [
      '           â†’ Selecciona productos del catÃ¡logo usando el dropdown en columna A',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['           â†’ Define TU precio de venta (columna B)', '', '', '', '', '', '', ''],
    ['           â†’ Las demÃ¡s columnas se llenan automÃ¡ticamente', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', ''],
    ['PASO 5ï¸âƒ£  Registrar movimientos de stock', '', '', '', '', '', '', ''],
    ['           â†’ Ve a ğŸ“¦ Movimientos Stock', '', '', '', '', '', '', ''],
    ['           â†’ Registra compras, ventas, ajustes, etc.', '', '', '', '', '', '', ''],
    ['           â†’ El stock se calcula automÃ¡ticamente', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', ''],
    ['PASO 6ï¸âƒ£  Monitorear lotes y vencimientos', '', '', '', '', '', '', ''],
    ['           â†’ Ve a ğŸ“Š Control Lotes', '', '', '', '', '', '', ''],
    ['           â†’ Esta hoja se llena AUTOMÃTICAMENTE', '', '', '', '', '', '', ''],
    ['           â†’ Muestra alertas de productos por vencer', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', ''],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SECTION 3: SHEET DESCRIPTIONS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['ğŸ“‘ 3. DESCRIPCIÃ“N DETALLADA DE CADA HOJA', '', '', '', '', '', '', ''],
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // 3.1 CategorÃ­as
    [
      'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚ ğŸ“‚ CATEGORÃAS - Estructura jerÃ¡rquica de productos', '', '', '', '', '', '', ''],
    [
      'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ PROPÃ“SITO: Organiza los productos en una estructura de Ã¡rbol con hasta 3 niveles de profundidad.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ COLUMNAS:', '', '', '', '', '', '', ''],
    [
      'â”‚   A. CÃ³digo        â†’ Identificador Ãºnico de la categorÃ­a (ej: NUT-CAN-SEC)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   B. CÃ³digo Padre  â†’ CategorÃ­a padre (vacÃ­o si es nivel 1)', '', '', '', '', '', '', ''],
    [
      'â”‚   C. Nivel         â†’ ğŸ”’ AUTOMÃTICO - Se calcula segÃºn jerarquÃ­a (1, 2 o 3)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   D. Nombre        â†’ Nombre visible de la categorÃ­a', '', '', '', '', '', '', ''],
    ['â”‚   E. DescripciÃ³n   â†’ ExplicaciÃ³n breve de quÃ© incluye', '', '', '', '', '', '', ''],
    ['â”‚   F. Ejemplos      â†’ Productos tÃ­picos de esta categorÃ­a', '', '', '', '', '', '', ''],
    [
      'â”‚   G. CategorÃ­a #   â†’ ğŸ”’ AUTOMÃTICO - Productos directos en esta categorÃ­a',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚   H. SubcategorÃ­a #â†’ ğŸ”’ AUTOMÃTICO - Productos en subcategorÃ­as',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚   I. # Total       â†’ ğŸ”’ AUTOMÃTICO - Total de productos (G + H)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   J. Activo        â†’ SÃ­/No - Si la categorÃ­a estÃ¡ habilitada', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ EJEMPLO DE JERARQUÃA:', '', '', '', '', '', '', ''],
    ['â”‚   Nivel 1: NUTRICIÃ“N', '', '', '', '', '', '', ''],
    ['â”‚     â””â”€ Nivel 2: NutriciÃ³n Canina', '', '', '', '', '', '', ''],
    ['â”‚          â””â”€ Nivel 3: Alimento Seco Perros', '', '', '', '', '', '', ''],
    ['â”‚          â””â”€ Nivel 3: Alimento HÃºmedo Perros', '', '', '', '', '', '', ''],
    ['â”‚          â””â”€ Nivel 3: Dietas Prescriptivas Perros', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // 3.2 Proveedores
    [
      'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚ ğŸ­ PROVEEDORES - Directorio de proveedores', '', '', '', '', '', '', ''],
    [
      'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ PROPÃ“SITO: Gestiona la informaciÃ³n de contacto y condiciones comerciales de tus proveedores.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ COLUMNAS PRINCIPALES:', '', '', '', '', '', '', ''],
    ['â”‚   A. CÃ³digo        â†’ Identificador Ãºnico (ej: PROV-001)', '', '', '', '', '', '', ''],
    ['â”‚   B. Nombre        â†’ Nombre comercial del proveedor', '', '', '', '', '', '', ''],
    ['â”‚   C. RazÃ³n Social  â†’ Nombre legal para facturaciÃ³n', '', '', '', '', '', '', ''],
    ['â”‚   D. RUC           â†’ NÃºmero de identificaciÃ³n tributaria', '', '', '', '', '', '', ''],
    ['â”‚   E. Tipo          â†’ Productos / Servicios / Ambos', '', '', '', '', '', '', ''],
    [
      'â”‚   F. CalificaciÃ³n  â†’ â­ a â­â­â­â­â­ (evaluaciÃ³n del proveedor)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   G-I. Contacto    â†’ TelÃ©fono, WhatsApp, Email', '', '', '', '', '', '', ''],
    ['â”‚   J-L. UbicaciÃ³n   â†’ Sitio web, DirecciÃ³n, Ciudad', '', '', '', '', '', '', ''],
    ['â”‚   M-N. Persona     â†’ Nombre y cargo del contacto principal', '', '', '', '', '', '', ''],
    ['â”‚   O. Pedido MÃ­n.   â†’ Monto mÃ­nimo de compra en Gs.', '', '', '', '', '', '', ''],
    ['â”‚   P. Condiciones   â†’ Contado / CrÃ©dito 15/30/60 dÃ­as', '', '', '', '', '', '', ''],
    ['â”‚   Q. DÃ­as Entrega  â†’ Tiempo promedio de entrega', '', '', '', '', '', '', ''],
    [
      'â”‚   R. Marcas        â†’ Marcas que distribuye (separadas por coma)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   V. Verificado    â†’ Si los datos fueron verificados', '', '', '', '', '', '', ''],
    ['â”‚   X. Activo        â†’ Si el proveedor estÃ¡ activo', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // 3.3 Marcas
    [
      'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚ ğŸ·ï¸ MARCAS - CatÃ¡logo de marcas comerciales', '', '', '', '', '', '', ''],
    [
      'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ PROPÃ“SITO: Registro de todas las marcas que comercializas, con informaciÃ³n Ãºtil para filtros y reportes.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ COLUMNAS:', '', '', '', '', '', '', ''],
    ['â”‚   A. CÃ³digo           â†’ Identificador Ãºnico (ej: royal-canin)', '', '', '', '', '', '', ''],
    ['â”‚   B. Nombre           â†’ Nombre de la marca', '', '', '', '', '', '', ''],
    [
      'â”‚   C. Tipo             â†’ AlimentaciÃ³n / FarmacÃ©utico / Accesorios / Higiene',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚   D. Segmento         â†’ Premium / EconÃ³mico / Veterinario Exclusivo',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   E. PaÃ­s             â†’ PaÃ­s de origen', '', '', '', '', '', '', ''],
    ['â”‚   F. Empresa Matriz   â†’ CorporaciÃ³n propietaria', '', '', '', '', '', '', ''],
    ['â”‚   G. FundaciÃ³n        â†’ AÃ±o de fundaciÃ³n', '', '', '', '', '', '', ''],
    ['â”‚   H. Especialidades   â†’ LÃ­neas de productos principales', '', '', '', '', '', '', ''],
    ['â”‚   I. Solo Veterinaria â†’ Si requiere venta en veterinarias', '', '', '', '', '', '', ''],
    ['â”‚   J. Distribuidor     â†’ Distribuidor local en Paraguay', '', '', '', '', '', '', ''],
    [
      'â”‚   M. # Productos      â†’ ğŸ”’ AUTOMÃTICO - Cantidad de productos de esta marca',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      "â”‚ âœ¨ Ya incluye +100 marcas: Royal Canin, Pro Plan, Hill's, Bravecto, NexGard, Nobivac, etc.",
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // 3.4 Productos (CatÃ¡logo Master)
    [
      'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚ ğŸ†• PRODUCTOS - CatÃ¡logo Master (mÃ¡s de 2000 productos)', '', '', '', '', '', '', ''],
    [
      'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ PROPÃ“SITO: Base de datos completa de productos disponibles. Selecciona de aquÃ­ para agregar a "Mis Productos".',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ COLUMNAS:', '', '', '', '', '', '', ''],
    [
      'â”‚   A. SKU              â†’ CÃ³digo Ãºnico del producto (ej: RC-DOG-MED-ADULT-15KG)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   B. Nombre           â†’ Nombre completo con presentaciÃ³n', '', '', '', '', '', '', ''],
    ['â”‚   C. CategorÃ­a        â†’ CategorÃ­a del producto (dropdown)', '', '', '', '', '', '', ''],
    ['â”‚   D. Marca            â†’ Marca del producto (dropdown)', '', '', '', '', '', '', ''],
    [
      'â”‚   E. Unid. Compra     â†’ CÃ³mo compras al proveedor (Bolsa, Caja, Blister)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   F. Cant. Contenida  â†’ CuÃ¡ntas unidades de venta contiene', '', '', '', '', '', '', ''],
    [
      'â”‚   G. Unid. Venta      â†’ CÃ³mo vendes al cliente (Unidad, Kg, Dosis)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   H. Precio Compra    â†’ Precio de compra por unidad de compra', '', '', '', '', '', '', ''],
    [
      'â”‚   I. Costo Unitario   â†’ ğŸ”’ AUTOMÃTICO - Costo por unidad de venta (H Ã· F)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   J. Proveedor        â†’ Proveedor principal (dropdown)', '', '', '', '', '', '', ''],
    ['â”‚   K. Especies         â†’ Perro / Gato / Ambos / Otros', '', '', '', '', '', '', ''],
    ['â”‚   L. Receta           â†’ Si requiere prescripciÃ³n veterinaria', '', '', '', '', '', '', ''],
    [
      'â”‚   M. En Stock         â†’ ğŸ”’ AUTOMÃTICO - Si lo tienes en "Mis Productos"',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   N. DescripciÃ³n      â†’ DescripciÃ³n detallada del producto', '', '', '', '', '', '', ''],
    ['â”‚   O. Activo           â†’ Si el producto estÃ¡ disponible', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ ğŸ’¡ INCLUYE: Alimentos (Royal Canin, Pro Plan, Dog Chow), Antiparasitarios (Bravecto, NexGard),',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚    Vacunas (Nobivac), Medicamentos (Virbac), Accesorios (Kong, Ferplast), y mucho mÃ¡s.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // 3.5 Mis Productos
    [
      'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚ ğŸ“‹ MIS PRODUCTOS - Tu inventario personalizado', '', '', '', '', '', '', ''],
    [
      'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ PROPÃ“SITO: Los productos que TÃš comercializas en tu clÃ­nica. Define tus precios de venta y stock mÃ­nimo.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ â­ COLUMNAS QUE TÃš LLENAS (solo 4):', '', '', '', '', '', '', ''],
    ['â”‚   A. Producto       â†’ ğŸ“ Selecciona del catÃ¡logo (dropdown)', '', '', '', '', '', '', ''],
    ['â”‚   B. Precio Venta   â†’ ğŸ“ Tu precio de venta en Gs.', '', '', '', '', '', '', ''],
    ['â”‚   C. Stock MÃ­nimo   â†’ ğŸ“ Cantidad mÃ­nima antes de alertar', '', '', '', '', '', '', ''],
    ['â”‚   D. UbicaciÃ³n      â†’ ğŸ“ DÃ³nde guardas este producto', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ ğŸ”’ COLUMNAS AUTOMÃTICAS (se llenan solas):', '', '', '', '', '', '', ''],
    ['â”‚   E. CÃ³digo         â†’ SKU del producto', '', '', '', '', '', '', ''],
    ['â”‚   F. DescripciÃ³n    â†’ DescripciÃ³n del catÃ¡logo', '', '', '', '', '', '', ''],
    ['â”‚   G. CategorÃ­a      â†’ CategorÃ­a asignada', '', '', '', '', '', '', ''],
    ['â”‚   H. Marca          â†’ Marca del producto', '', '', '', '', '', '', ''],
    ['â”‚   I. Proveedor      â†’ Proveedor principal', '', '', '', '', '', '', ''],
    ['â”‚   J. CÃ³digo Barras  â†’ Si estÃ¡ disponible', '', '', '', '', '', '', ''],
    ['â”‚   K. Receta         â†’ Si requiere prescripciÃ³n', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ ğŸ“Š COLUMNAS CALCULADAS (de movimientos):', '', '', '', '', '', '', ''],
    ['â”‚   L. Ãšlt. Costo     â†’ Ãšltimo costo de compra registrado', '', '', '', '', '', '', ''],
    ['â”‚   M. Margen %       â†’ (Precio Venta - Costo) Ã· Costo Ã— 100', '', '', '', '', '', '', ''],
    ['â”‚   N. Stock          â†’ Cantidad actual (suma de movimientos)', '', '', '', '', '', '', ''],
    ['â”‚   O. Valor          â†’ Stock Ã— Ãšltimo Costo', '', '', '', '', '', '', ''],
    ['â”‚   P. Estado         â†’ ğŸŸ¢ OK / ğŸŸ¡ Stock bajo / ğŸ”´ Sin stock', '', '', '', '', '', '', ''],
    ['â”‚   Q. PrÃ³x. Vence    â†’ Fecha del lote mÃ¡s prÃ³ximo a vencer', '', '', '', '', '', '', ''],
    ['â”‚   R. Alertas        â†’ Indicadores visuales de problemas', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // 3.6 Movimientos Stock
    [
      'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚ ğŸ“¦ MOVIMIENTOS STOCK - Registro de entradas y salidas', '', '', '', '', '', '', ''],
    [
      'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ PROPÃ“SITO: Registra TODAS las operaciones que afectan el stock. Es el "libro de movimientos" de tu inventario.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ â­ COLUMNAS QUE TÃš LLENAS:', '', '', '', '', '', '', ''],
    ['â”‚   A. Fecha          â†’ ğŸ“ Fecha del movimiento (dd/mm/yyyy)', '', '', '', '', '', '', ''],
    [
      'â”‚   B. Producto       â†’ ğŸ“ Selecciona de Mis Productos (dropdown)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   C. OperaciÃ³n      â†’ ğŸ“ Tipo de movimiento (dropdown):', '', '', '', '', '', '', ''],
    [
      'â”‚                         â€¢ Compra         â†’ Entrada de mercaderÃ­a (+)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚                         â€¢ Venta          â†’ Salida por venta (-)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚                         â€¢ Ajuste +       â†’ CorrecciÃ³n positiva (+)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚                         â€¢ Ajuste -       â†’ CorrecciÃ³n negativa (-)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚                         â€¢ DevoluciÃ³n Provâ†’ Devuelto al proveedor (-)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚                         â€¢ DevoluciÃ³n Cli â†’ Cliente devolviÃ³ (+)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚                         â€¢ Vencido        â†’ Producto vencido (-)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚                         â€¢ DaÃ±o           â†’ Producto daÃ±ado (-)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚                         â€¢ Uso Interno    â†’ Usado en clÃ­nica (-)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚                         â€¢ Transferencia  â†’ Movido entre ubicaciones (Â±)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚   D. Cantidad       â†’ ğŸ“ Cantidad del movimiento (siempre positivo)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚   E. Lote           â†’ ğŸ“ NÃºmero de lote (OBLIGATORIO para Compra)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   F. Responsable    â†’ ğŸ“ QuiÃ©n realizÃ³ el movimiento', '', '', '', '', '', '', ''],
    ['â”‚   G. Costo Unit.    â†’ ğŸ“ Costo por unidad (solo en Compra)', '', '', '', '', '', '', ''],
    [
      'â”‚   H. Vencimiento    â†’ ğŸ“ Fecha de vencimiento (solo en Compra)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ ğŸ”’ COLUMNAS AUTOMÃTICAS:', '', '', '', '', '', '', ''],
    ['â”‚   I. #              â†’ NÃºmero correlativo del movimiento', '', '', '', '', '', '', ''],
    ['â”‚   J. CÃ³digo         â†’ SKU del producto', '', '', '', '', '', '', ''],
    ['â”‚   K. Costo Usado    â†’ Costo aplicado (para valorizaciÃ³n)', '', '', '', '', '', '', ''],
    ['â”‚   L. +/-            â†’ Signo del movimiento (+1 o -1)', '', '', '', '', '', '', ''],
    ['â”‚   M. Total          â†’ Cantidad Ã— Signo (para sumas)', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ âš ï¸ IMPORTANTE: NUNCA borres movimientos. Si te equivocaste, crea un movimiento de Ajuste para corregir.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // 3.7 Control Lotes
    [
      'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”‚ ğŸ“Š CONTROL LOTES - Seguimiento de lotes y vencimientos (100% AUTOMÃTICO)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ PROPÃ“SITO: Monitorea el estado de cada lote de productos. Alerta sobre vencimientos prÃ³ximos.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ âš ï¸ NO EDITES ESTA HOJA - Se genera automÃ¡ticamente desde los movimientos de compra.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ ğŸ”’ TODAS LAS COLUMNAS SON AUTOMÃTICAS:', '', '', '', '', '', '', ''],
    ['â”‚   A. Producto       â†’ Nombre del producto', '', '', '', '', '', '', ''],
    ['â”‚   B. Lote           â†’ NÃºmero de lote', '', '', '', '', '', '', ''],
    ['â”‚   C. CÃ³digo         â†’ SKU del producto', '', '', '', '', '', '', ''],
    ['â”‚   D. F. Ingreso     â†’ Fecha de la primera compra del lote', '', '', '', '', '', '', ''],
    ['â”‚   E. Vencimiento    â†’ Fecha de vencimiento del lote', '', '', '', '', '', '', ''],
    [
      'â”‚   F. Cantidad       â†’ Stock actual del lote (entradas - salidas)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   G. Costo Unit.    â†’ Costo de compra del lote', '', '', '', '', '', '', ''],
    ['â”‚   H. Valor          â†’ Cantidad Ã— Costo', '', '', '', '', '', '', ''],
    [
      'â”‚   I. DÃ­as Vence     â†’ DÃ­as hasta vencimiento (negativo = vencido)',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   J. Estado         â†’ Indicador visual:', '', '', '', '', '', '', ''],
    ['â”‚                         ğŸŸ¢ OK         â†’ MÃ¡s de 90 dÃ­as', '', '', '', '', '', '', ''],
    ['â”‚                         ğŸŸ  Revisar    â†’ Entre 30-90 dÃ­as', '', '', '', '', '', '', ''],
    ['â”‚                         ğŸŸ¡ Por vencer â†’ Menos de 30 dÃ­as', '', '', '', '', '', '', ''],
    ['â”‚                         âš« Vencido    â†’ Ya pasÃ³ la fecha', '', '', '', '', '', '', ''],
    ['â”‚                         ğŸ”´ Agotado    â†’ Sin stock', '', '', '', '', '', '', ''],
    [
      'â”‚                         ğŸŸ¢ Sin venc.  â†’ No tiene fecha de vencimiento',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // 3.8 ConfiguraciÃ³n
    [
      'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚ âš™ï¸ CONFIGURACIÃ“N - ParÃ¡metros del sistema', '', '', '', '', '', '', ''],
    [
      'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ PROPÃ“SITO: Define valores que se usan en dropdowns y cÃ¡lculos.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ COLUMNAS:', '', '', '', '', '', '', ''],
    ['â”‚   A. ParÃ¡metro      â†’ Nombre del parÃ¡metro', '', '', '', '', '', '', ''],
    ['â”‚   B. Valor          â†’ Valor configurado', '', '', '', '', '', '', ''],
    ['â”‚   C. DescripciÃ³n    â†’ ExplicaciÃ³n del parÃ¡metro', '', '', '', '', '', '', ''],
    ['â”‚   D. Activo         â†’ Si estÃ¡ habilitado', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ PARÃMETROS INCLUIDOS:', '', '', '', '', '', '', ''],
    [
      'â”‚   â€¢ Ubicaciones     â†’ DepÃ³sito Principal, ExhibiciÃ³n, Farmacia, Refrigerador',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚   â€¢ Responsables    â†’ Personal autorizado para movimientos', '', '', '', '', '', '', ''],
    ['â”‚   â€¢ IVA             â†’ Tasa de impuesto (10%)', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // 3.9 Datos (Auxiliar)
    [
      'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚ ğŸ”§ DATOS - Hoja auxiliar para dropdowns (NO EDITAR)', '', '', '', '', '', '', ''],
    [
      'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ PROPÃ“SITO: Contiene listas que alimentan los menÃºs desplegables de otras hojas.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â”‚ âš ï¸ NO EDITES ESTA HOJA - Los cambios pueden romper los dropdowns.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â”‚', '', '', '', '', '', '', ''],
    ['â”‚ CONTIENE:', '', '', '', '', '', '', ''],
    ['â”‚   â€¢ Lista de categorÃ­as activas', '', '', '', '', '', '', ''],
    ['â”‚   â€¢ Lista de marcas activas', '', '', '', '', '', '', ''],
    ['â”‚   â€¢ Lista de proveedores activos', '', '', '', '', '', '', ''],
    ['â”‚   â€¢ Lista de productos del catÃ¡logo', '', '', '', '', '', '', ''],
    ['â”‚   â€¢ Lista de "Mis Productos" activos', '', '', '', '', '', '', ''],
    ['â”‚   â€¢ Lista de ubicaciones', '', '', '', '', '', '', ''],
    ['â”‚   â€¢ Lista de responsables', '', '', '', '', '', '', ''],
    ['â”‚', '', '', '', '', '', '', ''],
    [
      'â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SECTION 4: COMMON WORKFLOWS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['ğŸ”„ 4. FLUJOS DE TRABAJO COMUNES', '', '', '', '', '', '', ''],
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    ['ğŸ“¥ REGISTRAR UNA COMPRA:', '', '', '', '', '', '', ''],
    ['   1. Ve a ğŸ“¦ Movimientos Stock', '', '', '', '', '', '', ''],
    ['   2. En una fila nueva, ingresa:', '', '', '', '', '', '', ''],
    ['      â€¢ Fecha: La fecha de la factura', '', '', '', '', '', '', ''],
    ['      â€¢ Producto: Selecciona del dropdown', '', '', '', '', '', '', ''],
    ['      â€¢ OperaciÃ³n: "Compra"', '', '', '', '', '', '', ''],
    ['      â€¢ Cantidad: Unidades compradas', '', '', '', '', '', '', ''],
    ['      â€¢ Lote: NÃºmero del lote (de la etiqueta del producto)', '', '', '', '', '', '', ''],
    ['      â€¢ Responsable: QuiÃ©n recibiÃ³ la mercaderÃ­a', '', '', '', '', '', '', ''],
    ['      â€¢ Costo Unit.: Precio unitario de compra', '', '', '', '', '', '', ''],
    ['      â€¢ Vencimiento: Fecha de vencimiento del lote', '', '', '', '', '', '', ''],
    ['   3. El stock se actualiza automÃ¡ticamente en ğŸ“‹ Mis Productos', '', '', '', '', '', '', ''],
    ['   4. El lote aparece en ğŸ“Š Control Lotes', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', ''],

    ['ğŸ›’ REGISTRAR UNA VENTA:', '', '', '', '', '', '', ''],
    ['   1. Ve a ğŸ“¦ Movimientos Stock', '', '', '', '', '', '', ''],
    ['   2. En una fila nueva, ingresa:', '', '', '', '', '', '', ''],
    ['      â€¢ Fecha: La fecha de la venta', '', '', '', '', '', '', ''],
    ['      â€¢ Producto: Selecciona del dropdown', '', '', '', '', '', '', ''],
    ['      â€¢ OperaciÃ³n: "Venta"', '', '', '', '', '', '', ''],
    ['      â€¢ Cantidad: Unidades vendidas', '', '', '', '', '', '', ''],
    ['      â€¢ Lote: (opcional) Si sabes quÃ© lote saliÃ³', '', '', '', '', '', '', ''],
    ['      â€¢ Responsable: QuiÃ©n realizÃ³ la venta', '', '', '', '', '', '', ''],
    ['   3. El stock se descuenta automÃ¡ticamente', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', ''],

    ['â• AGREGAR UN PRODUCTO NUEVO:', '', '', '', '', '', '', ''],
    ['   OpciÃ³n A - Si existe en el catÃ¡logo:', '', '', '', '', '', '', ''],
    ['      1. Ve a ğŸ“‹ Mis Productos', '', '', '', '', '', '', ''],
    ['      2. En columna A, selecciona el producto del dropdown', '', '', '', '', '', '', ''],
    ['      3. Define tu precio de venta en columna B', '', '', '', '', '', '', ''],
    ['      4. Define stock mÃ­nimo y ubicaciÃ³n', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', ''],
    ['   OpciÃ³n B - Si NO existe en el catÃ¡logo:', '', '', '', '', '', '', ''],
    ['      1. Ve a ğŸ†• Productos (CatÃ¡logo Master)', '', '', '', '', '', '', ''],
    ['      2. Agrega el producto con todos sus datos', '', '', '', '', '', '', ''],
    ['      3. Luego agrÃ©galo a ğŸ“‹ Mis Productos', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', ''],

    ['ğŸ“Š REVISAR PRODUCTOS POR VENCER:', '', '', '', '', '', '', ''],
    ['   1. Ve a ğŸ“Š Control Lotes', '', '', '', '', '', '', ''],
    ['   2. Filtra por columna J (Estado):', '', '', '', '', '', '', ''],
    ['      â€¢ ğŸŸ¡ Por vencer â†’ Vence en menos de 30 dÃ­as', '', '', '', '', '', '', ''],
    ['      â€¢ ğŸŸ  Revisar â†’ Vence entre 30-90 dÃ­as', '', '', '', '', '', '', ''],
    ['      â€¢ âš« Vencido â†’ Ya pasÃ³ la fecha', '', '', '', '', '', '', ''],
    [
      '   3. Toma acciones: promocionar, devolver al proveedor, o dar de baja',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SECTION 5: TIPS AND WARNINGS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['ğŸ’¡ 5. CONSEJOS Y ADVERTENCIAS', '', '', '', '', '', '', ''],
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    ['âœ… SÃ PUEDES:', '', 'âš ï¸ NO HAGAS:', '', 'ğŸ’¡ CONSEJOS:', '', '', ''],
    ['', '', '', '', '', '', '', ''],
    [
      'â€¢ Agregar mÃ¡s filas de datos',
      '',
      'â€¢ Eliminar filas de encabezado (fila 1)',
      '',
      'â€¢ Usa los menÃºs desplegables (â–¼)',
      '',
      '',
      '',
    ],
    [
      'â€¢ Modificar datos de ejemplo',
      '',
      'â€¢ Cambiar nombres de las hojas',
      '',
      'â€¢ Precios siempre en GuaranÃ­es',
      '',
      '',
      '',
    ],
    [
      'â€¢ Borrar datos de ejemplo',
      '',
      'â€¢ Renombrar columnas',
      '',
      'â€¢ Fechas en formato dd/mm/yyyy',
      '',
      '',
      '',
    ],
    [
      'â€¢ Usar tus propios cÃ³digos',
      '',
      'â€¢ Editar la plantilla original',
      '',
      'â€¢ Usa filtros para buscar',
      '',
      '',
      '',
    ],
    [
      'â€¢ Dejar campos opcionales vacÃ­os',
      '',
      'â€¢ Borrar movimientos de stock',
      '',
      'â€¢ CÃ³digos Ãºnicos sin espacios',
      '',
      '',
      '',
    ],
    [
      'â€¢ Agregar nuevas categorÃ­as',
      '',
      'â€¢ Editar la hoja ğŸ”§ Datos',
      '',
      'â€¢ Revisa ğŸ“Š Control Lotes semanalmente',
      '',
      '',
      '',
    ],
    [
      'â€¢ Agregar nuevos proveedores',
      '',
      'â€¢ Dejar SKU o Nombre vacÃ­os',
      '',
      'â€¢ Haz backup periÃ³dicamente',
      '',
      '',
      '',
    ],
    [
      'â€¢ Agregar nuevas marcas',
      '',
      'â€¢ Usar cÃ³digos duplicados',
      '',
      'â€¢ Comparte con permisos de "Editor"',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SECTION 6: FAQ
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['â“ 6. PREGUNTAS FRECUENTES', '', '', '', '', '', '', ''],
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    ['P: Â¿CÃ³mo corrijo un error en el stock?', '', '', '', '', '', '', ''],
    [
      'R: Crea un movimiento de "Ajuste +" o "Ajuste -" con la diferencia. NUNCA borres movimientos existentes.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    ['P: Â¿QuÃ© pasa si un producto no aparece en el dropdown?', '', '', '', '', '', '', ''],
    [
      'R: Primero verifica que estÃ© en ğŸ†• Productos con "Activo = SÃ­". Si no existe, agrÃ©galo ahÃ­ primero.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    ['P: Â¿CÃ³mo agrego un nuevo proveedor?', '', '', '', '', '', '', ''],
    [
      'R: Ve a ğŸ­ Proveedores, agrega una nueva fila con toda la informaciÃ³n. El cÃ³digo debe ser Ãºnico.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    ['P: Â¿Por quÃ© no se calcula el stock automÃ¡ticamente?', '', '', '', '', '', '', ''],
    [
      'R: Verifica que el nombre del producto en ğŸ“¦ Movimientos coincida EXACTAMENTE con el de ğŸ“‹ Mis Productos.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    ['P: Â¿CÃ³mo registro un producto vencido o daÃ±ado?', '', '', '', '', '', '', ''],
    [
      'R: Crea un movimiento con operaciÃ³n "Vencido" o "DaÃ±o". Esto descuenta el stock sin afectar las ventas.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    ['P: Â¿Puedo tener el mismo producto en varias ubicaciones?', '', '', '', '', '', '', ''],
    [
      'R: No directamente. Para esto, registra la ubicaciÃ³n al momento de la compra y usa filtros para ver por ubicaciÃ³n.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    ['P: Â¿CÃ³mo sincronizo con el sistema web?', '', '', '', '', '', '', ''],
    [
      'R: En tu panel web, ve a ConfiguraciÃ³n â†’ Importar desde Sheets. Pega el enlace de TU COPIA y sigue las instrucciones.',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    ['', '', '', '', '', '', '', ''],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // FOOTER
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ['', '', '', '', '', '', '', ''],
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'ğŸ“‹ VersiÃ³n 3.0 | Vete - Sistema Veterinario | Â¿Dudas? Contacta soporte tÃ©cnico: soporte@vete.com.py',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
    [
      'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
    ],
  ]
}

/**
 * Add all sample data to the spreadsheet
 */
export async function addSampleData(spreadsheetId: string = SPREADSHEET_ID): Promise<void> {
  console.log('\nğŸ“ Adding sample data from JSON files...\n')

  // ğŸ“– GuÃ­a RÃ¡pida - Horizontal layout
  console.log('  ğŸ“– GuÃ­a RÃ¡pida...')
  const guideContent = getGuideContent()
  await updateValues(spreadsheetId, `'ğŸ“– GuÃ­a RÃ¡pida'!A1:H${guideContent.length}`, guideContent)

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“‚ CategorÃ­as - Load from JSON (10 columns)
  // A-CÃ³digo, B-CÃ³digo Padre, C-Nivel(formula), D-Nombre, E-DescripciÃ³n, F-Ejemplos,
  // G-CategorÃ­a#(formula), H-SubcategorÃ­a#(formula), I-#ProductosTotal(formula), J-Activo
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  console.log('  ğŸ“‚ CategorÃ­as...')

  const categories = loadCategories()
  console.log(`    â†’ Loaded ${categories.length} categories from JSON`)

  const maxCatRows = Math.max(100, categories.length + 10)

  // FÃ³rmulas para Nivel (C) - calculates hierarchy depth
  const levelFormulas: string[][] = []
  for (let i = 2; i <= maxCatRows; i++) {
    levelFormulas.push([
      `=IF(A${i}<>"",IF(B${i}="",1,IF(COUNTIF($B$2:$B$${maxCatRows},B${i})>0,VLOOKUP(B${i},$A$2:$C$${maxCatRows},3,FALSE)+1,2)),"")`,
    ])
  }

  // FÃ³rmulas para CategorÃ­a # (G) - direct count from products sheet
  // Always counts products that have this exact category name
  // Uses explicit range to avoid full column reference (performance)
  const catCategoryCountFormulas: string[][] = []
  for (let i = 2; i <= maxCatRows; i++) {
    catCategoryCountFormulas.push([`=IF(D${i}<>"",COUNTIF('ğŸ†• Productos'!$C$2:$C$2100,D${i}),"")`])
  }

  // FÃ³rmulas para SubcategorÃ­a # (H) - sum of children's totals
  // - If category has children: SUM of children's (Category # + Subcategory #) = SUM of children's I column
  // - If leaf (no children): 0
  const catSubcategoryCountFormulas: string[][] = []
  for (let i = 2; i <= maxCatRows; i++) {
    catSubcategoryCountFormulas.push([
      `=IF(D${i}<>"",IF(COUNTIF($B$2:$B$${maxCatRows},A${i})>0,SUMIF($B$2:$B$${maxCatRows},A${i},$I$2:$I$${maxCatRows}),0),"")`,
    ])
  }

  // FÃ³rmulas para # Productos Total (I) - sum of Category # + Subcategory #
  const catTotalCountFormulas: string[][] = []
  for (let i = 2; i <= maxCatRows; i++) {
    catTotalCountFormulas.push([`=IF(D${i}<>"",G${i}+H${i},"")`])
  }

  // Map categories to spreadsheet format (columns A, B, D, E, F, J - skip C, G, H, I which are formulas)
  const categoryRows = categories.map((c) => [
    c.slug, // A: CÃ³digo
    c.parent_slug || '', // B: CÃ³digo Padre
    c.name, // D: Nombre (will write to D separately)
    c.description || '', // E: DescripciÃ³n
    c.examples || '-', // F: Ejemplos
    'SÃ­', // J: Activo (moved from H)
  ])

  // Batch write all category data in a single API call
  const categoryBatchData: Array<{ range: string; values: any[][] }> = [
    { range: `'ğŸ“‚ CategorÃ­as'!C2:C${maxCatRows}`, values: levelFormulas },
    { range: `'ğŸ“‚ CategorÃ­as'!G2:G${maxCatRows}`, values: catCategoryCountFormulas },
    { range: `'ğŸ“‚ CategorÃ­as'!H2:H${maxCatRows}`, values: catSubcategoryCountFormulas },
    { range: `'ğŸ“‚ CategorÃ­as'!I2:I${maxCatRows}`, values: catTotalCountFormulas },
  ]
  if (categoryRows.length > 0) {
    categoryBatchData.push(
      {
        range: `'ğŸ“‚ CategorÃ­as'!A2:B${categoryRows.length + 1}`,
        values: categoryRows.map((r) => [r[0], r[1]]),
      },
      {
        range: `'ğŸ“‚ CategorÃ­as'!D2:F${categoryRows.length + 1}`,
        values: categoryRows.map((r) => [r[2], r[3], r[4]]),
      },
      {
        range: `'ğŸ“‚ CategorÃ­as'!J2:J${categoryRows.length + 1}`,
        values: categoryRows.map((r) => [r[5]]),
      }
    )
  }
  await batchUpdateValues(spreadsheetId, categoryBatchData)

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ·ï¸ Marcas - Load from JSON (15 columns)
  // A-CÃ³digo, B-Nombre, C-Tipo, D-Segmento, E-PaÃ­s, F-Empresa Matriz, G-FundaciÃ³n,
  // H-Especialidades, I-Solo Veterinaria, J-Distribuidor, K-Sitio Web, L-Productos Clave,
  // M-#Productos(formula), N-DescripciÃ³n, O-Activo
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  console.log('  ğŸ·ï¸ Marcas...')

  const brands = loadBrands()
  console.log(`    â†’ Loaded ${brands.length} brands from JSON`)

  // Max rows for formulas
  const maxBrandRows = Math.max(150, brands.length + 10)

  // FÃ³rmulas for auto-generated codes (A)
  const brandFormulas: string[][] = []
  for (let i = 2; i <= maxBrandRows; i++) {
    brandFormulas.push([
      `=IF(B${i}<>"",UPPER(LEFT(SUBSTITUTE(B${i}," ",""),2))&"-"&TEXT(SUMPRODUCT((UPPER(LEFT(SUBSTITUTE($B$2:B${i}," ",""),2))=UPPER(LEFT(SUBSTITUTE(B${i}," ",""),2)))*1),"000"),"")`,
    ])
  }

  // FÃ³rmulas for #Productos (M) - counts products with this brand
  // Uses explicit range to avoid full column reference
  const brandProductCountFormulas: string[][] = []
  for (let i = 2; i <= maxBrandRows; i++) {
    brandProductCountFormulas.push([`=IF(B${i}<>"",COUNTIF('ğŸ†• Productos'!$D$2:$D$2100,B${i}),"")`])
  }

  // Segment translation map (English to Spanish)
  const segmentMap: Record<string, string> = {
    economy: 'EconÃ³mico',
    standard: 'EstÃ¡ndar',
    premium: 'Premium',
    'super-premium': 'Super Premium',
    veterinary: 'Veterinario',
    professional: 'Profesional',
  }

  // Brand type translation map
  const brandTypeMap: Record<string, string> = {
    alimentos: 'Alimentos',
    farmacia: 'Farmacia',
    accesorios: 'Accesorios',
    higiene: 'Higiene',
    equipos: 'Equipos',
    consumibles: 'Consumibles',
    suplementos: 'Suplementos',
  }

  // Map brands to spreadsheet format (columns B-L, N-O - skip A and M which are formulas)
  const brandRowsBL = brands.map((b) => [
    b.name, // B: Nombre
    brandTypeMap[b.brand_type] || b.brand_type || '', // C: Tipo
    segmentMap[b.market_segment] || b.market_segment || '', // D: Segmento
    b.country_origin || '', // E: PaÃ­s
    b.parent_company || '', // F: Empresa Matriz
    b.founded_year || '', // G: FundaciÃ³n
    b.specialties || '', // H: Especialidades
    b.is_veterinary_exclusive ? 'SÃ­' : 'No', // I: Solo Veterinaria
    b.local_distributor || '', // J: Distribuidor
    b.website || '', // K: Sitio Web
    b.key_products || '', // L: Productos Clave
  ])

  const brandRowsNO = brands.map((b) => [
    b.description || '', // N: DescripciÃ³n
    'SÃ­', // O: Activo
  ])

  // Batch write all brand data in a single API call
  const brandBatchData: Array<{ range: string; values: any[][] }> = [
    { range: `'ğŸ·ï¸ Marcas'!A2:A${maxBrandRows}`, values: brandFormulas },
    { range: `'ğŸ·ï¸ Marcas'!M2:M${maxBrandRows}`, values: brandProductCountFormulas },
  ]
  if (brandRowsBL.length > 0) {
    brandBatchData.push(
      { range: `'ğŸ·ï¸ Marcas'!B2:L${brandRowsBL.length + 1}`, values: brandRowsBL },
      { range: `'ğŸ·ï¸ Marcas'!N2:O${brandRowsNO.length + 1}`, values: brandRowsNO }
    )
  }
  await batchUpdateValues(spreadsheetId, brandBatchData)

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ­ Proveedores - Load from JSON (24 columns)
  // A-CÃ³digo(formula), B-Nombre, C-RazÃ³n Social, D-RUC, E-Tipo, F-CalificaciÃ³n, G-TelÃ©fono, H-WhatsApp,
  // I-Email, J-Sitio Web, K-DirecciÃ³n, L-Ciudad, M-Persona Contacto, N-Cargo,
  // O-Pedido MÃ­n., P-Condiciones Pago, Q-DÃ­as Entrega, R-Marcas,
  // S-#Productos(formula), T-Total Compras(formula), U-Ãšltima Compra(formula), V-Verificado, W-Notas, X-Activo
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  console.log('  ğŸ­ Proveedores...')

  const suppliers = loadSuppliers()
  console.log(`    â†’ Loaded ${suppliers.length} suppliers from JSON`)

  const maxSupplierRows = Math.max(100, suppliers.length + 10)

  // FÃ³rmulas for auto-generated codes (A)
  const providerFormulas: string[][] = []
  for (let i = 2; i <= maxSupplierRows; i++) {
    providerFormulas.push([
      `=IF(B${i}<>"",UPPER(LEFT(SUBSTITUTE(B${i}," ",""),3))&"-"&TEXT(SUMPRODUCT((UPPER(LEFT(SUBSTITUTE($B$2:B${i}," ",""),3))=UPPER(LEFT(SUBSTITUTE(B${i}," ",""),3)))*1),"000"),"")`,
    ])
  }

  // FÃ³rmulas for #Productos (S) - counts products from this supplier
  // Uses explicit range to avoid full column reference
  const provProductCountFormulas: string[][] = []
  for (let i = 2; i <= maxSupplierRows; i++) {
    provProductCountFormulas.push([`=IF(B${i}<>"",COUNTIF('ğŸ†• Productos'!$J$2:$J$2100,B${i}),"")`])
  }

  // FÃ³rmulas for Total Compras (T) - sum of purchases from this supplier
  // Joins through Mis Productos to find products from this supplier, then sums from Movimientos
  // Uses SUMPRODUCT to match: Product in Mov â†’ Proveedor in MisProd â†’ matches Supplier name
  const provTotalPurchasesFormulas: string[][] = []
  for (let i = 2; i <= maxSupplierRows; i++) {
    // Sum Total (O) from Movimientos where product's supplier (via Mis Productos J) = this supplier
    provTotalPurchasesFormulas.push([
      `=IF(B${i}<>"",IFERROR(SUMPRODUCT(('ğŸ“¦ Movimientos Stock'!$C$2:$C$1001="Compra")*(IFERROR(VLOOKUP('ğŸ“¦ Movimientos Stock'!$B$2:$B$1001,'ğŸ“‹ Mis Productos'!$A$2:$J$501,10,FALSE),"")=B${i})*('ğŸ“¦ Movimientos Stock'!$O$2:$O$1001)),""),"")`,
    ])
  }

  // FÃ³rmulas for Ãšltima Compra (U) - last purchase date from this supplier
  // Uses array formula to find max date where product's supplier matches
  const provLastPurchaseFormulas: string[][] = []
  for (let i = 2; i <= maxSupplierRows; i++) {
    provLastPurchaseFormulas.push([
      `=IF(B${i}<>"",IFERROR(MAX(IF(('ğŸ“¦ Movimientos Stock'!$C$2:$C$1001="Compra")*(IFERROR(VLOOKUP('ğŸ“¦ Movimientos Stock'!$B$2:$B$1001,'ğŸ“‹ Mis Productos'!$A$2:$J$501,10,FALSE),"")=B${i}),'ğŸ“¦ Movimientos Stock'!$A$2:$A$1001)),""),"")`,
    ])
  }

  // Map suppliers to spreadsheet format (columns B-R, skip S-U formulas, then V-X)
  // Phone/WhatsApp values start with '+' which Sheets interprets as formula
  // Prefix with ' (apostrophe) to force text interpretation
  const formatPhone = (val: string | undefined): string => {
    if (!val) return ''
    // Prefix with ' if starts with + or number to force text
    return val.startsWith('+') || /^\d/.test(val) ? `'${val}` : val
  }

  const supplierRowsBR = suppliers.map((s) => [
    s.name, // B: Nombre
    s.legal_name || '', // C: RazÃ³n Social
    s.ruc || '', // D: RUC
    s.type, // E: Tipo
    'â­â­â­', // F: CalificaciÃ³n (default 3 stars)
    formatPhone(s.phone), // G: TelÃ©fono (prefix ' for + numbers)
    formatPhone(s.whatsapp), // H: WhatsApp (prefix ' for + numbers)
    s.email || '', // I: Email
    s.website || '', // J: Sitio Web
    s.address || '', // K: DirecciÃ³n
    s.city, // L: Ciudad
    s.contact_name || '', // M: Persona Contacto
    s.contact_position || '', // N: Cargo
    s.min_order_gs || '', // O: Pedido MÃ­n.(Gs)
    s.payment_terms || '', // P: Condiciones Pago
    s.delivery_days || '', // Q: DÃ­as Entrega
    s.brands || '', // R: Marcas
  ])

  const supplierRowsVX = suppliers.map((s) => [
    s.verified ? 'Verificado' : 'Pendiente', // V: Verificado
    s.notes || '', // W: Notas
    s.active ? 'SÃ­' : 'No', // X: Activo
  ])

  // Batch write all supplier data in a single API call
  const supplierBatchData: Array<{ range: string; values: any[][] }> = [
    { range: `'ğŸ­ Proveedores'!A2:A${maxSupplierRows}`, values: providerFormulas },
    { range: `'ğŸ­ Proveedores'!S2:S${maxSupplierRows}`, values: provProductCountFormulas },
    { range: `'ğŸ­ Proveedores'!T2:T${maxSupplierRows}`, values: provTotalPurchasesFormulas },
    { range: `'ğŸ­ Proveedores'!U2:U${maxSupplierRows}`, values: provLastPurchaseFormulas },
  ]
  if (supplierRowsBR.length > 0) {
    supplierBatchData.push(
      { range: `'ğŸ­ Proveedores'!B2:R${supplierRowsBR.length + 1}`, values: supplierRowsBR },
      { range: `'ğŸ­ Proveedores'!V2:X${supplierRowsVX.length + 1}`, values: supplierRowsVX }
    )
  }
  await batchUpdateValues(spreadsheetId, supplierBatchData)

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ†• Productos - Load from JSON (15 columns)
  // A-SKU, B-Nombre, C-CategorÃ­a, D-Marca, E-Unid.Compra, F-Cant.Contenida, G-Unid.Venta,
  // H-PrecioCompra, I-CostoUnit(formula), J-Proveedor, K-Especies, L-Receta, M-EnStock(formula), N-DescripciÃ³n, O-Activo
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  console.log('  ğŸ†• Productos (CatÃ¡logo Master)...')

  const products = loadProducts()
  console.log(`    â†’ Loaded ${products.length} products (with variants) from JSON`)

  // Build brand slug to name map
  const brandMap = new Map<string, string>()
  brands.forEach((b) => brandMap.set(b.slug, b.name))

  // Build category slug to name map (for reference)
  const categoryMap = new Map<string, string>()
  categories.forEach((c) => categoryMap.set(c.slug, c.name))

  // Build brand name â†’ supplier name mapping (reverse lookup from suppliers.brands)
  const brandToSupplier = new Map<string, string>()
  suppliers.forEach((s) => {
    // s.brands is a comma-separated string like "Royal Canin, Pro Plan, Hill's"
    const brandList = s.brands.split(',').map((b) => b.trim().toLowerCase())
    brandList.forEach((brandName) => {
      if (!brandToSupplier.has(brandName)) {
        brandToSupplier.set(brandName, s.name)
      }
    })
  })

  // Species translation map
  const speciesMap: Record<string, string> = {
    dog: 'Perro',
    cat: 'Gato',
    bird: 'Ave',
    fish: 'Pez',
    rabbit: 'Conejo',
    hamster: 'HÃ¡mster',
    other: 'Otro',
  }

  // Max rows for formulas
  const maxProductRows = Math.max(1200, products.length + 10)

  // FÃ³rmulas para Costo Unitario (columna I) = Precio Compra / Cant. Contenida
  const costFormulas: string[][] = []
  for (let i = 2; i <= maxProductRows; i++) {
    costFormulas.push([`=IF(AND(H${i}<>"",F${i}<>"",F${i}>0),ROUND(H${i}/F${i},0),"")`])
  }

  // FÃ³rmulas para En Stock (columna M) = checks if product exists in Mis Productos
  const enStockFormulas: string[][] = []
  for (let i = 2; i <= maxProductRows; i++) {
    enStockFormulas.push([`=IF(B${i}<>"",IF(COUNTIF('ğŸ“‹ Mis Productos'!$A:$A,B${i})>0,"âœ“",""),"")`])
  }

  // Map products to spreadsheet format (15 columns: A-L, skip M, then N-O)
  // A-SKU, B-Nombre, C-CategorÃ­a, D-Marca, E-Unid.Compra, F-Cant.Contenida, G-Unid.Venta,
  // H-PrecioCompra, I-(formula), J-Proveedor, K-Especies, L-Receta, M-(formula), N-DescripciÃ³n, O-Activo
  const productRowsAL = products.map((p) => {
    // Get brand name and look up supplier
    const brandName = brandMap.get(p.brand_slug) || p.brand_slug
    const supplierName = brandToSupplier.get(brandName.toLowerCase()) || ''

    // Translate species from "cat, dog" to "Gato, Perro"
    const translatedSpecies = p.target_species
      .split(',')
      .map((s) => s.trim())
      .map((s) => speciesMap[s.toLowerCase()] || s)
      .join(', ')

    return [
      p.sku, // A: SKU
      p.name, // B: Nombre
      categoryMap.get(p.category_slug) || p.category_slug, // C: CategorÃ­a (name for user friendliness)
      brandName, // D: Marca (name)
      'Unidad', // E: Unid. Compra
      1, // F: Cant. Contenida
      'Unidad', // G: Unid. Venta
      p.cost_price || 0, // H: Precio Compra (cost)
      '', // I: (formula - skip)
      supplierName, // J: Proveedor (from brand mapping)
      translatedSpecies, // K: Especies (translated to Spanish)
      p.requires_prescription ? 'SÃ­' : 'No', // L: Receta
    ]
  })

  const productRowsNO = products.map((p) => [
    p.description || '', // N: DescripciÃ³n
    'SÃ­', // O: Activo
  ])

  // Batch write all product data in a single API call
  const productBatchData: Array<{ range: string; values: any[][] }> = [
    { range: `'ğŸ†• Productos'!I2:I${maxProductRows}`, values: costFormulas },
    { range: `'ğŸ†• Productos'!M2:M${maxProductRows}`, values: enStockFormulas },
  ]
  if (productRowsAL.length > 0) {
    productBatchData.push(
      { range: `'ğŸ†• Productos'!A2:L${productRowsAL.length + 1}`, values: productRowsAL },
      { range: `'ğŸ†• Productos'!N2:O${productRowsNO.length + 1}`, values: productRowsNO }
    )
  }
  await batchUpdateValues(spreadsheetId, productBatchData)

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“‹ Mis Productos (19 columns A-S)
  // Client enters: A-Producto, B-PrecioVenta, C-StockMÃ­n, D-UbicaciÃ³n, E-Activo (5 cols)
  // Auto-fill from catalog: F-L (7 cols)
  // Auto-calculated: M-S (7 cols)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  console.log('  ğŸ“‹ Mis Productos...')

  const maxMisProductosRows = 501

  // === AUTO-FILL FROM CATALOG (columns F-L) ===
  // Use INDEX/MATCH because VLOOKUP can't look left (SKU is col A, Name is col B)
  // ğŸ†• Productos structure: A-SKU, B-Nombre, C-CategorÃ­a, D-Marca, E-Unid.Compra, F-Cant, G-Unid.Venta,
  //                        H-PrecioCompra, I-CostoUnit, J-Proveedor, K-Especies, L-Receta, M-EnStock, N-DescripciÃ³n, O-Activo

  // F: CÃ³digo (SKU) = INDEX/MATCH from catalog (col A, lookup in col B)
  const codigoFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    codigoFormulas.push([
      `=IF(A${i}<>"",IFERROR(INDEX('ğŸ†• Productos'!$A$2:$A$2100,MATCH(A${i},'ğŸ†• Productos'!$B$2:$B$2100,0)),""),"")`,
    ])
  }

  // G: DescripciÃ³n = INDEX/MATCH from catalog (col N)
  const descripcionFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    descripcionFormulas.push([
      `=IF(A${i}<>"",IFERROR(INDEX('ğŸ†• Productos'!$N$2:$N$2100,MATCH(A${i},'ğŸ†• Productos'!$B$2:$B$2100,0)),""),"")`,
    ])
  }

  // H: CategorÃ­a = INDEX/MATCH from catalog (col C)
  const categoriaFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    categoriaFormulas.push([
      `=IF(A${i}<>"",IFERROR(INDEX('ğŸ†• Productos'!$C$2:$C$2100,MATCH(A${i},'ğŸ†• Productos'!$B$2:$B$2100,0)),""),"")`,
    ])
  }

  // I: Marca = INDEX/MATCH from catalog (col D)
  const marcaFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    marcaFormulas.push([
      `=IF(A${i}<>"",IFERROR(INDEX('ğŸ†• Productos'!$D$2:$D$2100,MATCH(A${i},'ğŸ†• Productos'!$B$2:$B$2100,0)),""),"")`,
    ])
  }

  // J: Proveedor = INDEX/MATCH from catalog (col J)
  const proveedorFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    proveedorFormulas.push([
      `=IF(A${i}<>"",IFERROR(INDEX('ğŸ†• Productos'!$J$2:$J$2100,MATCH(A${i},'ğŸ†• Productos'!$B$2:$B$2100,0)),""),"")`,
    ])
  }

  // K: CÃ³digo Barras = from catalog (we'll leave empty, user can fill)
  const codigoBarrasFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    codigoBarrasFormulas.push([``]) // Empty, user fills if needed
  }

  // L: Receta = INDEX/MATCH from catalog (col L)
  const recetaFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    recetaFormulas.push([
      `=IF(A${i}<>"",IFERROR(INDEX('ğŸ†• Productos'!$L$2:$L$2100,MATCH(A${i},'ğŸ†• Productos'!$B$2:$B$2100,0)),""),"")`,
    ])
  }

  // === AUTO-CALCULATED (columns M-S) ===
  // M: Ãšltimo Costo = last purchase cost from movements (where OperaciÃ³n="Compra")
  // Movimientos structure: A-Fecha, B-Producto, C-OperaciÃ³n, D-Cantidad, E-Lote, F-UbicaciÃ³n, G-Responsable, H-CostoUnit, I-Vencimiento, J-Documento, K-#, L-CÃ³digo, M-CostoUsado, N-+/-, O-Total
  const lastCostFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    // H is Costo Unit. in Movimientos
    lastCostFormulas.push([
      `=IF(A${i}<>"",IFERROR(INDEX('ğŸ“¦ Movimientos Stock'!$H$2:$H$1001,MATCH(2,1/('ğŸ“¦ Movimientos Stock'!$B$2:$B$1001=A${i})*1/('ğŸ“¦ Movimientos Stock'!$C$2:$C$1001="Compra")*1/('ğŸ“¦ Movimientos Stock'!$H$2:$H$1001<>""),1)),""),"")`,
    ])
  }

  // N: Margen % = (PrecioVenta - ÃšltimoCosto) / ÃšltimoCosto * 100 (as NUMBER, not text)
  const marginFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    // Returns actual number so we can format as percentage in formatting.ts
    marginFormulas.push([`=IF(AND(A${i}<>"",B${i}<>"",M${i}<>"",M${i}>0),(B${i}-M${i})/M${i},"")`])
  }

  // O: Stock Actual = sum based on operation signs from movements
  // Uses SUMPRODUCT with explicit range to exclude headers. N is +/- column in Movimientos
  const stockActualFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    stockActualFormulas.push([
      `=IF(A${i}<>"",SUMPRODUCT(('ğŸ“¦ Movimientos Stock'!$B$2:$B$1001=A${i})*('ğŸ“¦ Movimientos Stock'!$D$2:$D$1001)*('ğŸ“¦ Movimientos Stock'!$N$2:$N$1001)),"")`,
    ])
  }

  // P: Valor Stock = Stock * ÃšltimoCosto
  const valorStockFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    valorStockFormulas.push([`=IF(AND(A${i}<>"",O${i}<>"",M${i}<>""),O${i}*M${i},"")`])
  }

  // Q: Estado = emoji based on stock level
  const estadoFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    estadoFormulas.push([`=IF(A${i}<>"",IF(O${i}<=0,"ğŸ”´",IF(O${i}<=C${i},"ğŸŸ¡","ğŸŸ¢")),"")`])
  }

  // R: PrÃ³ximo Vencimiento = earliest expiration from active lots (exclude headers)
  // I is Vencimiento in Movimientos
  const proxVenceFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    proxVenceFormulas.push([
      `=IF(A${i}<>"",IFERROR(MINIFS('ğŸ“¦ Movimientos Stock'!$I$2:$I$1001,'ğŸ“¦ Movimientos Stock'!$B$2:$B$1001,A${i},'ğŸ“¦ Movimientos Stock'!$I$2:$I$1001,">"&TODAY()),""),"")`,
    ])
  }

  // S: Alertas = warnings for expiration, low stock, etc.
  const alertasFormulas: string[][] = []
  for (let i = 2; i <= maxMisProductosRows; i++) {
    alertasFormulas.push([
      `=IF(A${i}<>"",IFS(O${i}<=0,"âŒ Sin stock",AND(R${i}<>"",R${i}<TODAY()),"âš ï¸ Vencido",AND(R${i}<>"",R${i}<TODAY()+30),"â° Por vencer",O${i}<=C${i},"ğŸ“¦ Stock bajo",TRUE,"âœ… OK"),"")`,
    ])
  }

  // Batch write all Mis Productos formulas
  await batchUpdateValues(spreadsheetId, [
    // Auto-fill from catalog (F-L)
    { range: `'ğŸ“‹ Mis Productos'!F2:F${maxMisProductosRows}`, values: codigoFormulas },
    { range: `'ğŸ“‹ Mis Productos'!G2:G${maxMisProductosRows}`, values: descripcionFormulas },
    { range: `'ğŸ“‹ Mis Productos'!H2:H${maxMisProductosRows}`, values: categoriaFormulas },
    { range: `'ğŸ“‹ Mis Productos'!I2:I${maxMisProductosRows}`, values: marcaFormulas },
    { range: `'ğŸ“‹ Mis Productos'!J2:J${maxMisProductosRows}`, values: proveedorFormulas },
    { range: `'ğŸ“‹ Mis Productos'!K2:K${maxMisProductosRows}`, values: codigoBarrasFormulas },
    { range: `'ğŸ“‹ Mis Productos'!L2:L${maxMisProductosRows}`, values: recetaFormulas },
    // Auto-calculated (M-S)
    { range: `'ğŸ“‹ Mis Productos'!M2:M${maxMisProductosRows}`, values: lastCostFormulas },
    { range: `'ğŸ“‹ Mis Productos'!N2:N${maxMisProductosRows}`, values: marginFormulas },
    { range: `'ğŸ“‹ Mis Productos'!O2:O${maxMisProductosRows}`, values: stockActualFormulas },
    { range: `'ğŸ“‹ Mis Productos'!P2:P${maxMisProductosRows}`, values: valorStockFormulas },
    { range: `'ğŸ“‹ Mis Productos'!Q2:Q${maxMisProductosRows}`, values: estadoFormulas },
    { range: `'ğŸ“‹ Mis Productos'!R2:R${maxMisProductosRows}`, values: proxVenceFormulas },
    { range: `'ğŸ“‹ Mis Productos'!S2:S${maxMisProductosRows}`, values: alertasFormulas },
  ])

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SIMPLIFIED CLINIC INVENTORY
  // Client enters ONLY 4 columns: [Producto, PrecioVenta, StockMÃ­n, UbicaciÃ³n]
  // Everything else is auto-filled from catalog or calculated from movements
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  // Helper to find product by SKU from the loaded products array
  // Returns [name, price, minStock, location] tuple or null if not found
  const findBySku = (
    sku: string,
    minStock: number,
    location: string
  ): [string, number, number, string] | null => {
    const product = products.find((p) => p.sku === sku)
    if (!product) {
      console.warn(`    âš ï¸ Product not found: ${sku}`)
      return null
    }
    return [product.name, product.base_price, minStock, location]
  }

  // Build clinic inventory from actual catalog products (ensures names match exactly)
  // Format: [ProductName, SalePrice, MinStock, Location]
  const clinicInventoryItems: Array<[string, number, number, string] | null> = [
    // ğŸ›’ TIENDA - ALIMENTOS PERROS
    findBySku('RC-DOG-MED-ADULT-15KG', 3, 'ExhibiciÃ³n'),
    findBySku('RC-DOG-MED-ADULT-3KG', 4, 'ExhibiciÃ³n'),
    findBySku('PP-DOG-ADULT-MED-15KG', 3, 'ExhibiciÃ³n'),
    findBySku('PP-DOG-PUPPY-MED-15KG', 3, 'ExhibiciÃ³n'),
    findBySku('DC-DOG-ADULT-MED-LG-21KG', 4, 'DepÃ³sito Principal'),
    findBySku('PED-DOG-ADULT-21KG', 5, 'DepÃ³sito Principal'),
    // ğŸ›’ TIENDA - ALIMENTOS GATOS
    findBySku('RC-CAT-STERILISED-4KG', 3, 'ExhibiciÃ³n'),
    findBySku('WHK-CAT-ADULT-PESCADO-10KG', 4, 'DepÃ³sito Principal'),
    findBySku('CC-CAT-ADULT-8KG', 4, 'DepÃ³sito Principal'),
    // ğŸ›’ TIENDA - DIETAS PRESCRIPTIVAS
    findBySku('RC-DOG-RENAL-7KG', 2, 'Farmacia'),
    findBySku('RC-DOG-GASTRO-7.5KG', 2, 'Farmacia'),
    // ğŸ›’ ANTIPARASITARIOS
    findBySku('FRT-PLUS-DOG-M-1PIP', 6, 'Farmacia'),
    findBySku('FRT-PLUS-DOG-L-1PIP', 5, 'Farmacia'),
    findBySku('FRT-PLUS-CAT-1PIP', 6, 'Farmacia'),
    findBySku('NXG-DOG-10-25-1', 5, 'Farmacia'),
    findBySku('BRV-DOG-20-40-1', 3, 'Farmacia'),
    findBySku('BRV-DOG-10-20-1', 3, 'Farmacia'),
    // ğŸ›’ HIGIENE
    findBySku('CATRON-NATURAL-10KG', 6, 'DepÃ³sito Principal'),
    findBySku('CATRON-LAVANDA-10KG', 4, 'DepÃ³sito Principal'),
    // ğŸ›’ ACCESORIOS
    findBySku('KONG-CLASSIC-M', 3, 'ExhibiciÃ³n'),
    findBySku('KONG-CLASSIC-L', 2, 'ExhibiciÃ³n'),
    findBySku('FPL-CARRIER-ATLAS-M-20', 2, 'ExhibiciÃ³n'),
    // ğŸ’‰ VACUNAS
    findBySku('NOB-DHPPI-1D', 10, 'Farmacia'),
    findBySku('NOB-RABIA-1D', 15, 'Farmacia'),
    findBySku('NOB-TRICAT-1D', 8, 'Farmacia'),
    findBySku('NOB-LEPTO-1D', 10, 'Farmacia'),
    // ğŸ’‰ FLUIDOTERAPIA Y CONSUMIBLES
    findBySku('BRAUN-NACL-09-500', 10, 'Farmacia'),
    findBySku('BRAUN-RINGER-LACTATO-500', 8, 'Farmacia'),
    findBySku('BRAUN-DEXTROSA-5-500', 6, 'Farmacia'),
    findBySku('BD-SYRINGE-3ML-23G', 2, 'Consultorio'),
    findBySku('BD-SYRINGE-5ML-21G', 2, 'Consultorio'),
  ]

  // Filter out null entries (products not found in catalog)
  const clinicInventory = clinicInventoryItems.filter(
    (item): item is [string, number, number, string] => item !== null
  )

  // Write simplified data: 5 client-entry columns (A-E) including Activo
  const myProductRows = clinicInventory.map((p) => [p[0], p[1], p[2], p[3], 'SÃ­']) // Add Activo = 'SÃ­' for all

  if (myProductRows.length > 0) {
    await batchUpdateValues(spreadsheetId, [
      { range: `'ğŸ“‹ Mis Productos'!A2:E${myProductRows.length + 1}`, values: myProductRows },
    ])
  }

  console.log(`    â†’ Created ${clinicInventory.length} clinic products (5 cols each)`)

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“¦ Movimientos Stock (15 columns A-O)
  // Client enters (A-J): Fecha, Producto, OperaciÃ³n, Cantidad, Lote, UbicaciÃ³n, Responsable, CostoUnit, Vencimiento, Documento
  // Auto-calculated (K-O): #, CÃ³digo, CostoUsado, +/-, Total
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  console.log('  ğŸ“¦ Movimientos Stock...')

  const maxStockRows = 1001

  // === AUTO-CALCULATED FORMULAS (columns K-O) ===

  // K: ğŸ”’ # = auto-increment row number
  const rowNumberFormulas: string[][] = []
  for (let i = 2; i <= maxStockRows; i++) {
    rowNumberFormulas.push([`=IF(A${i}<>"",ROW()-1,"")`])
  }

  // L: ğŸ”’ CÃ³digo = VLOOKUP from Mis Productos (column F has the code now)
  const codigoMovFormulas: string[][] = []
  for (let i = 2; i <= maxStockRows; i++) {
    codigoMovFormulas.push([
      `=IF(B${i}<>"",IFERROR(VLOOKUP(B${i},'ğŸ“‹ Mis Productos'!$A$2:$F$501,6,FALSE),""),"")`,
    ])
  }

  // M: ğŸ”’ Costo Usado = For Compra use column H, else use last purchase cost
  // Uses INDEX/MATCH to find the most recent Compra cost for this product
  // H is Costo Unit. in new structure
  const costoUsadoFormulas: string[][] = []
  for (let i = 2; i <= maxStockRows; i++) {
    costoUsadoFormulas.push([
      `=IF(B${i}<>"",IF(C${i}="Compra",H${i},IFERROR(INDEX($H$2:$H$${maxStockRows},MATCH(2,1/($B$2:$B$${maxStockRows}=B${i})*1/($C$2:$C$${maxStockRows}="Compra")*1/($H$2:$H$${maxStockRows}<>""),1)),"")),"")`,
    ])
  }

  // N: ğŸ”’ +/- = Sign based on operation type
  // Compra, DevoluciÃ³n Cliente, Ajuste +, Hallazgo = 1
  // Venta, Uso Interno, DevoluciÃ³n Proveedor, Ajuste -, DaÃ±o, Vencido = -1
  const signFormulas: string[][] = []
  for (let i = 2; i <= maxStockRows; i++) {
    signFormulas.push([
      `=IF(C${i}<>"",IFS(OR(C${i}="Compra",C${i}="DevoluciÃ³n Cliente",C${i}="Ajuste +",C${i}="Hallazgo"),1,OR(C${i}="Venta",C${i}="Uso Interno",C${i}="DevoluciÃ³n Proveedor",C${i}="Ajuste -",C${i}="DaÃ±o",C${i}="Vencido"),-1,TRUE,0),"")`,
    ])
  }

  // O: ğŸ’° Total = Cantidad Ã— CostoUsado Ã— sign
  const totalFormulas: string[][] = []
  for (let i = 2; i <= maxStockRows; i++) {
    totalFormulas.push([`=IF(AND(D${i}<>"",M${i}<>""),D${i}*M${i}*N${i},"")`])
  }

  // Batch write all Movimientos Stock formulas
  await batchUpdateValues(spreadsheetId, [
    { range: `'ğŸ“¦ Movimientos Stock'!K2:K${maxStockRows}`, values: rowNumberFormulas },
    { range: `'ğŸ“¦ Movimientos Stock'!L2:L${maxStockRows}`, values: codigoMovFormulas },
    { range: `'ğŸ“¦ Movimientos Stock'!M2:M${maxStockRows}`, values: costoUsadoFormulas },
    { range: `'ğŸ“¦ Movimientos Stock'!N2:N${maxStockRows}`, values: signFormulas },
    { range: `'ğŸ“¦ Movimientos Stock'!O2:O${maxStockRows}`, values: totalFormulas },
  ])

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SAMPLE STOCK MOVEMENTS - FULL FORMAT (10 client columns)
  // [Fecha, Producto, OperaciÃ³n, Cantidad, Lote, UbicaciÃ³n, Responsable, CostoUnit, Vencimiento, Documento]
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Stock movements using EXACT product names from JSON catalog and Mis Productos
  const stockMovements = [
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ğŸ“… 01/12/2024 - INVENTARIO INICIAL (Compras de apertura)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // [Fecha, Producto, OperaciÃ³n, Cantidad, Lote, UbicaciÃ³n, Responsable, CostoUnit, Vencimiento, Documento]
    [
      '01/12/2024',
      'Royal Canin Medium Adult 15kg',
      'Compra',
      10,
      'L2024-RC01',
      'ExhibiciÃ³n',
      'Juan PÃ©rez',
      537000,
      '15/12/2025',
      'FAC-001-2024',
    ],
    [
      '01/12/2024',
      'Royal Canin Medium Adult 3kg',
      'Compra',
      15,
      'L2024-RC02',
      'ExhibiciÃ³n',
      'Juan PÃ©rez',
      147000,
      '15/12/2025',
      'FAC-001-2024',
    ],
    [
      '01/12/2024',
      'Pro Plan Adult Medium 15kg',
      'Compra',
      10,
      'L2024-PP01',
      'ExhibiciÃ³n',
      'Juan PÃ©rez',
      417000,
      '10/11/2025',
      'FAC-002-2024',
    ],
    [
      '01/12/2024',
      'Dog Chow Adultos Medianos y Grandes 21kg',
      'Compra',
      15,
      'L2024-DC01',
      'DepÃ³sito Principal',
      'Juan PÃ©rez',
      255000,
      '30/10/2025',
      'FAC-003-2024',
    ],
    [
      '01/12/2024',
      'Pedigree Adulto 21kg',
      'Compra',
      18,
      'L2024-PD01',
      'DepÃ³sito Principal',
      'Juan PÃ©rez',
      195000,
      '20/09/2025',
      'FAC-003-2024',
    ],
    [
      '01/12/2024',
      'Whiskas Adulto Pescado 10kg',
      'Compra',
      12,
      'L2024-WH01',
      'DepÃ³sito Principal',
      'Juan PÃ©rez',
      207000,
      '20/09/2025',
      'FAC-004-2024',
    ],

    // Antiparasitarios
    [
      '01/12/2024',
      'Frontline Plus Perros 10-20kg 1 pipeta',
      'Compra',
      20,
      'FL-2024-M01',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      37200,
      '30/06/2026',
      'FAC-005-2024',
    ],
    [
      '01/12/2024',
      'Frontline Plus Perros 20-40kg 1 pipeta',
      'Compra',
      15,
      'FL-2024-L01',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      43200,
      '30/06/2026',
      'FAC-005-2024',
    ],
    [
      '01/12/2024',
      'NexGard Perros 10-25kg 1 comprimido',
      'Compra',
      15,
      'NX-2024-M01',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      69000,
      '31/08/2026',
      'FAC-006-2024',
    ],
    [
      '01/12/2024',
      'Bravecto Perros 20-40kg 1 comprimido',
      'Compra',
      8,
      'BV-2024-L01',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      237000,
      '30/09/2026',
      'FAC-006-2024',
    ],
    [
      '01/12/2024',
      'Bravecto Perros 10-20kg 1 comprimido',
      'Compra',
      6,
      'BV-2024-M01',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      207000,
      '30/09/2026',
      'FAC-006-2024',
    ],

    // Vacunas
    [
      '01/12/2024',
      'Nobivac DHPPi 1 dosis',
      'Compra',
      30,
      'NB-DHPP-2024',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      51000,
      '30/06/2025',
      'FAC-007-2024',
    ],
    [
      '01/12/2024',
      'Nobivac Rabies 1 dosis',
      'Compra',
      50,
      'NB-RAB-2024',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      27000,
      '31/12/2025',
      'FAC-007-2024',
    ],
    [
      '01/12/2024',
      'Nobivac Tricat Trio 1 dosis',
      'Compra',
      25,
      'NB-TRI-2024',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      57000,
      '30/06/2025',
      'FAC-007-2024',
    ],
    [
      '01/12/2024',
      'Nobivac Lepto 1 dosis',
      'Compra',
      20,
      'NB-LEP-2024',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      33000,
      '30/06/2025',
      'FAC-007-2024',
    ],

    // Consumibles y Fluidoterapia
    [
      '01/12/2024',
      'Jeringa BD 3ml con Aguja Caja x 100 (23G)',
      'Compra',
      6,
      'BD-J3-2024',
      'Consultorio',
      'Juan PÃ©rez',
      111000,
      '31/12/2027',
      'FAC-008-2024',
    ],
    [
      '01/12/2024',
      'Jeringa BD 5ml con Aguja Caja x 100 (21G)',
      'Compra',
      4,
      'BD-J5-2024',
      'Consultorio',
      'Juan PÃ©rez',
      135000,
      '31/12/2027',
      'FAC-008-2024',
    ],
    [
      '01/12/2024',
      'SoluciÃ³n Salina 0.9% 500ml',
      'Compra',
      40,
      'SS-2024-01',
      'Farmacia',
      'Juan PÃ©rez',
      15000,
      '30/11/2025',
      'FAC-009-2024',
    ],
    [
      '01/12/2024',
      'Ringer Lactato 500ml',
      'Compra',
      30,
      'RL-2024-01',
      'Farmacia',
      'Juan PÃ©rez',
      16800,
      '30/11/2025',
      'FAC-009-2024',
    ],
    [
      '01/12/2024',
      'Dextrosa 5% 500ml',
      'Compra',
      20,
      'DX-2024-01',
      'Farmacia',
      'Juan PÃ©rez',
      13200,
      '30/11/2025',
      'FAC-009-2024',
    ],

    // Higiene y Accesorios
    [
      '01/12/2024',
      'Catron Arena Natural 10kg',
      'Compra',
      15,
      'CAT-2024-01',
      'DepÃ³sito Principal',
      'Juan PÃ©rez',
      69000,
      '31/12/2026',
      'FAC-010-2024',
    ],
    [
      '01/12/2024',
      'Kong Classic M',
      'Compra',
      8,
      'KONG-M-2024',
      'ExhibiciÃ³n',
      'Juan PÃ©rez',
      66300,
      '',
      'FAC-011-2024',
    ],
    [
      '01/12/2024',
      'Ferplast Atlas 20 Transportadora 58x37x32cm',
      'Compra',
      4,
      'FPL-20-2024',
      'ExhibiciÃ³n',
      'Juan PÃ©rez',
      135000,
      '',
      'FAC-011-2024',
    ],

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ğŸ“… 02-08/12/2024 - PRIMERA SEMANA DE OPERACIONES
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    [
      '02/12/2024',
      'Royal Canin Medium Adult 15kg',
      'Venta',
      2,
      '',
      'ExhibiciÃ³n',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-001-2024',
    ],
    [
      '03/12/2024',
      'Dog Chow Adultos Medianos y Grandes 21kg',
      'Venta',
      3,
      '',
      'DepÃ³sito Principal',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-002-2024',
    ],
    [
      '04/12/2024',
      'Pedigree Adulto 21kg',
      'Venta',
      4,
      '',
      'DepÃ³sito Principal',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-003-2024',
    ],
    [
      '04/12/2024',
      'Frontline Plus Perros 10-20kg 1 pipeta',
      'Venta',
      3,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      'TKT-003-2024',
    ],
    [
      '05/12/2024',
      'NexGard Perros 10-25kg 1 comprimido',
      'Venta',
      2,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      'TKT-004-2024',
    ],
    [
      '06/12/2024',
      'Whiskas Adulto Pescado 10kg',
      'Venta',
      2,
      '',
      'DepÃ³sito Principal',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-005-2024',
    ],

    // Uso clÃ­nico (vacunaciones)
    [
      '03/12/2024',
      'Nobivac DHPPi 1 dosis',
      'Uso Interno',
      5,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],
    [
      '04/12/2024',
      'Nobivac Rabies 1 dosis',
      'Uso Interno',
      8,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],
    [
      '05/12/2024',
      'Nobivac Tricat Trio 1 dosis',
      'Uso Interno',
      3,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],

    // Uso clÃ­nico (consultas y cirugÃ­as)
    [
      '06/12/2024',
      'Jeringa BD 3ml con Aguja Caja x 100 (23G)',
      'Uso Interno',
      1,
      '',
      'Consultorio',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],
    [
      '07/12/2024',
      'SoluciÃ³n Salina 0.9% 500ml',
      'Uso Interno',
      6,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],
    [
      '07/12/2024',
      'Ringer Lactato 500ml',
      'Uso Interno',
      4,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ğŸ“… 09-15/12/2024 - SEGUNDA SEMANA
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    [
      '09/12/2024',
      'Royal Canin Medium Adult 15kg',
      'Venta',
      3,
      '',
      'ExhibiciÃ³n',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-006-2024',
    ],
    [
      '10/12/2024',
      'Royal Canin Medium Adult 3kg',
      'Venta',
      2,
      '',
      'ExhibiciÃ³n',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-007-2024',
    ],
    [
      '10/12/2024',
      'Pro Plan Adult Medium 15kg',
      'Venta',
      2,
      '',
      'ExhibiciÃ³n',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-007-2024',
    ],
    [
      '11/12/2024',
      'Frontline Plus Perros 20-40kg 1 pipeta',
      'Venta',
      4,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      'TKT-008-2024',
    ],
    [
      '11/12/2024',
      'Bravecto Perros 20-40kg 1 comprimido',
      'Venta',
      2,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      'TKT-008-2024',
    ],
    [
      '12/12/2024',
      'Frontline Plus Gatos 1 pipeta',
      'Venta',
      3,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      'TKT-009-2024',
    ],

    // ReposiciÃ³n por bajo stock
    [
      '12/12/2024',
      'Frontline Plus Perros 10-20kg 1 pipeta',
      'Compra',
      15,
      'FL-2024-M02',
      'Farmacia',
      'Juan PÃ©rez',
      37200,
      '30/06/2026',
      'FAC-012-2024',
    ],
    [
      '13/12/2024',
      'Dog Chow Adultos Medianos y Grandes 21kg',
      'Compra',
      10,
      'L2024-DC02',
      'DepÃ³sito Principal',
      'Juan PÃ©rez',
      255000,
      '28/02/2026',
      'FAC-013-2024',
    ],
    [
      '13/12/2024',
      'Frontline Plus Gatos 1 pipeta',
      'Compra',
      12,
      'FL-CAT-2024',
      'Farmacia',
      'Juan PÃ©rez',
      33000,
      '30/06/2026',
      'FAC-014-2024',
    ],

    // MÃ¡s uso clÃ­nico
    [
      '13/12/2024',
      'Nobivac DHPPi 1 dosis',
      'Uso Interno',
      6,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],
    [
      '13/12/2024',
      'Nobivac Rabies 1 dosis',
      'Uso Interno',
      5,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],
    [
      '14/12/2024',
      'Jeringa BD 3ml con Aguja Caja x 100 (23G)',
      'Uso Interno',
      1,
      '',
      'Consultorio',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ğŸ“… 16-22/12/2024 - TERCERA SEMANA (Navidad, mÃ¡s ventas)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    [
      '16/12/2024',
      'Royal Canin Medium Adult 15kg',
      'Venta',
      2,
      '',
      'ExhibiciÃ³n',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-010-2024',
    ],
    [
      '17/12/2024',
      'Royal Canin Medium Adult 3kg',
      'Venta',
      3,
      '',
      'ExhibiciÃ³n',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-011-2024',
    ],
    [
      '18/12/2024',
      'Kong Classic M',
      'Venta',
      2,
      '',
      'ExhibiciÃ³n',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-012-2024',
    ],
    [
      '18/12/2024',
      'Ferplast Atlas 20 Transportadora 58x37x32cm',
      'Venta',
      1,
      '',
      'ExhibiciÃ³n',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-012-2024',
    ],

    // MÃ¡s ventas y uso
    [
      '20/12/2024',
      'NexGard Perros 10-25kg 1 comprimido',
      'Venta',
      3,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      'TKT-013-2024',
    ],
    [
      '20/12/2024',
      'Nobivac DHPPi 1 dosis',
      'Uso Interno',
      4,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],
    [
      '21/12/2024',
      'SoluciÃ³n Salina 0.9% 500ml',
      'Uso Interno',
      5,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      '',
    ],

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ğŸ“… 23-31/12/2024 - SEMANA NAVIDAD/AÃ‘O NUEVO
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    [
      '23/12/2024',
      'Pedigree Adulto 21kg',
      'Venta',
      3,
      '',
      'DepÃ³sito Principal',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-014-2024',
    ],
    [
      '23/12/2024',
      'Cat Chow Adultos Carne y Pollo 8kg',
      'Venta',
      2,
      '',
      'DepÃ³sito Principal',
      'Ana GarcÃ­a',
      '',
      '',
      'TKT-014-2024',
    ],

    // Producto daÃ±ado
    [
      '26/12/2024',
      'Catron Arena Natural 10kg',
      'DaÃ±o',
      1,
      '',
      'DepÃ³sito Principal',
      'Juan PÃ©rez',
      '',
      '',
      'INF-001-2024',
    ],

    // Ventas post-navidad
    [
      '28/12/2024',
      'Frontline Plus Perros 10-20kg 1 pipeta',
      'Venta',
      5,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      'TKT-015-2024',
    ],
    [
      '28/12/2024',
      'Frontline Plus Perros 20-40kg 1 pipeta',
      'Venta',
      3,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      'TKT-015-2024',
    ],
    [
      '29/12/2024',
      'Bravecto Perros 10-20kg 1 comprimido',
      'Venta',
      2,
      '',
      'Farmacia',
      'Dra. MarÃ­a LÃ³pez',
      '',
      '',
      'TKT-016-2024',
    ],

    // DevoluciÃ³n de cliente
    [
      '30/12/2024',
      'Royal Canin Sterilised 4kg',
      'DevoluciÃ³n Cliente',
      1,
      '',
      'ExhibiciÃ³n',
      'Ana GarcÃ­a',
      '',
      '',
      'DEV-001-2024',
    ],

    // Compra fin de aÃ±o
    [
      '30/12/2024',
      'Nobivac DHPPi 1 dosis',
      'Compra',
      25,
      'NB-DHPP-2025',
      'Farmacia',
      'Juan PÃ©rez',
      51000,
      '30/06/2025',
      'FAC-015-2024',
    ],
    [
      '30/12/2024',
      'Nobivac Rabies 1 dosis',
      'Compra',
      30,
      'NB-RAB-2025',
      'Farmacia',
      'Juan PÃ©rez',
      27000,
      '31/12/2025',
      'FAC-015-2024',
    ],

    // Ãšltimo dÃ­a
    [
      '31/12/2024',
      'SoluciÃ³n Salina 0.9% 500ml',
      'Uso Interno',
      4,
      '',
      'Farmacia',
      'Dr. Carlos Ruiz',
      '',
      '',
      '',
    ],
    [
      '31/12/2024',
      'Ringer Lactato 500ml',
      'Uso Interno',
      3,
      '',
      'Farmacia',
      'Dr. Carlos Ruiz',
      '',
      '',
      '',
    ],
    [
      '31/12/2024',
      'Dextrosa 5% 500ml',
      'Uso Interno',
      2,
      '',
      'Farmacia',
      'Dr. Carlos Ruiz',
      '',
      '',
      '',
    ],
  ]

  // Write data to columns A-J (10 client entry columns)
  // [Fecha, Producto, OperaciÃ³n, Cantidad, Lote, UbicaciÃ³n, Responsable, CostoUnit, Vencimiento, Documento]
  const stockRows = stockMovements.map((m) => [
    m[0],
    m[1],
    m[2],
    m[3],
    m[4],
    m[5],
    m[6],
    m[7],
    m[8],
    m[9],
  ])

  if (stockRows.length > 0) {
    await batchUpdateValues(spreadsheetId, [
      { range: `'ğŸ“¦ Movimientos Stock'!A2:J${stockRows.length + 1}`, values: stockRows },
    ])
  }
  console.log(`    â†’ Created ${stockMovements.length} stock movements (full format)`)

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“Š Control Lotes - 100% FORMULA-BASED (11 columns A-K)
  // Aggregates lot information from movements for expiration tracking
  // Column structure: A-Producto, B-Lote (from UNIQUE), C-K (formulas)
  // Movimientos structure: A-Fecha, B-Producto, C-OperaciÃ³n, D-Cantidad, E-Lote, F-UbicaciÃ³n, G-Responsable, H-CostoUnit, I-Vencimiento, J-Documento, K-#, L-CÃ³digo, M-CostoUsado, N-+/-, O-Total
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  console.log('  ğŸ“Š Control Lotes...')

  // A2: Master UNIQUE formula - returns Product+Lote pairs from Compra operations
  // This array formula spills into columns A and B - uses explicit range to exclude headers
  const lotesUniqueFormula = [
    [
      "=IFERROR(UNIQUE(FILTER({'ğŸ“¦ Movimientos Stock'!B$2:B$1001,'ğŸ“¦ Movimientos Stock'!E$2:E$1001},'ğŸ“¦ Movimientos Stock'!E$2:E$1001<>\"\",'ğŸ“¦ Movimientos Stock'!C$2:C$1001=\"Compra\")),\"\")",
    ],
  ]

  const maxLotesRows = 1001 // Increased to 1000 data rows
  const maxMovRows = 1001 // Movement rows range

  // C: ğŸ”’ CÃ³digo = VLOOKUP from Mis Productos (column F now has SKU)
  const loteCodigoFormulas: string[][] = []
  for (let i = 2; i <= maxLotesRows; i++) {
    loteCodigoFormulas.push([
      `=IF(A${i}<>"",IFERROR(VLOOKUP(A${i},'ğŸ“‹ Mis Productos'!$A$2:$F$501,6,FALSE),""),"")`,
    ])
  }

  // D: ğŸ“… F.Ingreso = First purchase date for this Product+Lote
  const loteIngresoFormulas: string[][] = []
  for (let i = 2; i <= maxLotesRows; i++) {
    loteIngresoFormulas.push([
      `=IF(AND(A${i}<>"",B${i}<>""),IFERROR(MINIFS('ğŸ“¦ Movimientos Stock'!$A$2:$A$${maxMovRows},'ğŸ“¦ Movimientos Stock'!$B$2:$B$${maxMovRows},A${i},'ğŸ“¦ Movimientos Stock'!$E$2:$E$${maxMovRows},B${i},'ğŸ“¦ Movimientos Stock'!$C$2:$C$${maxMovRows},"Compra"),""),"")`,
    ])
  }

  // E: ğŸ“… Vencimiento = Expiration date from purchase (lookup on Product+Lote)
  // Column I is Vencimiento in new Movimientos structure
  const loteVencimientoFormulas: string[][] = []
  for (let i = 2; i <= maxLotesRows; i++) {
    loteVencimientoFormulas.push([
      `=IF(AND(A${i}<>"",B${i}<>""),IFERROR(INDEX('ğŸ“¦ Movimientos Stock'!$I$2:$I$${maxMovRows},MATCH(1,('ğŸ“¦ Movimientos Stock'!$B$2:$B$${maxMovRows}=A${i})*('ğŸ“¦ Movimientos Stock'!$E$2:$E$${maxMovRows}=B${i})*('ğŸ“¦ Movimientos Stock'!$C$2:$C$${maxMovRows}="Compra"),0)),""),"")`,
    ])
  }

  // F: ğŸ“¦ Cantidad = Remaining stock (sum entries - exits for this Product+Lote)
  // Uses SUMPRODUCT with sign column (N is +/- in new structure) - explicit ranges to exclude headers
  const loteCantidadFormulas: string[][] = []
  for (let i = 2; i <= maxLotesRows; i++) {
    loteCantidadFormulas.push([
      `=IF(AND(A${i}<>"",B${i}<>""),SUMPRODUCT(('ğŸ“¦ Movimientos Stock'!$B$2:$B$${maxMovRows}=A${i})*('ğŸ“¦ Movimientos Stock'!$E$2:$E$${maxMovRows}=B${i})*('ğŸ“¦ Movimientos Stock'!$D$2:$D$${maxMovRows})*('ğŸ“¦ Movimientos Stock'!$N$2:$N$${maxMovRows})),"")`,
    ])
  }

  // G: ğŸ’° Costo Unit. = Purchase cost for this lot (H is CostoUnit in new structure)
  const loteCostoFormulas: string[][] = []
  for (let i = 2; i <= maxLotesRows; i++) {
    loteCostoFormulas.push([
      `=IF(AND(A${i}<>"",B${i}<>""),IFERROR(INDEX('ğŸ“¦ Movimientos Stock'!$H$2:$H$${maxMovRows},MATCH(1,('ğŸ“¦ Movimientos Stock'!$B$2:$B$${maxMovRows}=A${i})*('ğŸ“¦ Movimientos Stock'!$E$2:$E$${maxMovRows}=B${i})*('ğŸ“¦ Movimientos Stock'!$C$2:$C$${maxMovRows}="Compra"),0)),""),"")`,
    ])
  }

  // H: ğŸ’µ Valor = Cantidad Ã— Costo Unit.
  const loteValorFormulas: string[][] = []
  for (let i = 2; i <= maxLotesRows; i++) {
    loteValorFormulas.push([
      `=IF(AND(F${i}<>"",G${i}<>"",ISNUMBER(F${i}),ISNUMBER(G${i})),F${i}*G${i},"")`,
    ])
  }

  // I: â³ DÃ­as Vence = Days until expiration (negative = already expired)
  // Handle text dates by using DATEVALUE for text, or raw value for date numbers
  const loteDiasFormulas: string[][] = []
  for (let i = 2; i <= maxLotesRows; i++) {
    loteDiasFormulas.push([
      `=IF(E${i}<>"",IFERROR(IF(ISNUMBER(E${i}),E${i}-TODAY(),DATEVALUE(E${i})-TODAY()),""),"")`,
    ])
  }

  // J: ğŸš¦ Estado = Simplified status with emoji
  const loteEstadoFormulas: string[][] = []
  for (let i = 2; i <= maxLotesRows; i++) {
    loteEstadoFormulas.push([
      `=IF(A${i}<>"",IF(NOT(ISNUMBER(F${i})),"âšª",IF(F${i}<=0,"ğŸ”´",IF(NOT(ISNUMBER(I${i})),"ğŸŸ¢",IF(I${i}<0,"âš«",IF(I${i}<=30,"ğŸŸ¡",IF(I${i}<=90,"ğŸŸ ","ğŸŸ¢")))))),"")`,
    ])
  }

  // K: ğŸ“‹ Orden FIFO = Pick order (FEFO priority - earliest expiration first, then oldest receipt)
  // 1 = use first, higher = use later. Excludes depleted lots (F=0) and expired (I<0)
  const loteFIFOFormulas: string[][] = []
  for (let i = 2; i <= maxLotesRows; i++) {
    loteFIFOFormulas.push([
      `=IF(AND(A${i}<>"",ISNUMBER(F${i}),F${i}>0),IFERROR(RANK(IF(ISNUMBER(E${i}),E${i},DATE(2099,12,31))+D${i}/1000000,IF(($F$2:$F$${maxLotesRows}>0)*($A$2:$A$${maxLotesRows}=A${i}),IF(ISNUMBER($E$2:$E$${maxLotesRows}),$E$2:$E$${maxLotesRows},DATE(2099,12,31))+$D$2:$D$${maxLotesRows}/1000000,""),1),""),"")`,
    ])
  }

  // First, write the master UNIQUE formula (spills into A and B)
  await updateValues(spreadsheetId, "'ğŸ“Š Control Lotes'!A2", lotesUniqueFormula)

  // Then write all individual column formulas (C-K)
  await batchUpdateValues(spreadsheetId, [
    { range: `'ğŸ“Š Control Lotes'!C2:C${maxLotesRows}`, values: loteCodigoFormulas },
    { range: `'ğŸ“Š Control Lotes'!D2:D${maxLotesRows}`, values: loteIngresoFormulas },
    { range: `'ğŸ“Š Control Lotes'!E2:E${maxLotesRows}`, values: loteVencimientoFormulas },
    { range: `'ğŸ“Š Control Lotes'!F2:F${maxLotesRows}`, values: loteCantidadFormulas },
    { range: `'ğŸ“Š Control Lotes'!G2:G${maxLotesRows}`, values: loteCostoFormulas },
    { range: `'ğŸ“Š Control Lotes'!H2:H${maxLotesRows}`, values: loteValorFormulas },
    { range: `'ğŸ“Š Control Lotes'!I2:I${maxLotesRows}`, values: loteDiasFormulas },
    { range: `'ğŸ“Š Control Lotes'!J2:J${maxLotesRows}`, values: loteEstadoFormulas },
    { range: `'ğŸ“Š Control Lotes'!K2:K${maxLotesRows}`, values: loteFIFOFormulas },
  ])

  console.log('    â†’ Created lot tracking formulas (11 columns, FIFO/FEFO order)')

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // âš™ï¸ ConfiguraciÃ³n - Side-by-side tables (9 columns A-I)
  // Ubicaciones table: A-D (CÃ³digo, UbicaciÃ³n, DescripciÃ³n, Activo)
  // Empty separator: E
  // Responsables table: F-I (ID, Responsable, Rol/Cargo, Activo)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  console.log('  âš™ï¸ ConfiguraciÃ³n (tablas separadas)...')

  // Ubicaciones data (A-D)
  const ubicacionesData = [
    ['DEP-MAIN', 'DepÃ³sito Principal', 'AlmacÃ©n general de inventario', 'SÃ­'],
    ['DEP-FARM', 'Farmacia', 'Medicamentos y productos refrigerados', 'SÃ­'],
    ['DEP-REFR', 'Refrigerador', 'Vacunas y productos que requieren frÃ­o', 'SÃ­'],
    ['DEP-CONS', 'Consultorio', 'Stock de uso diario en consultas', 'SÃ­'],
    ['DEP-EXHI', 'ExhibiciÃ³n', 'Productos en tienda para venta', 'SÃ­'],
    ['DEP-CIRU', 'CirugÃ­a', 'Insumos y equipos quirÃºrgicos', 'SÃ­'],
    ['DEP-ARCH', 'Archivo', 'UbicaciÃ³n para items dados de baja', 'No'],
  ]

  // Responsables data (F-I)
  const responsablesData = [
    ['STAFF-001', 'Juan PÃ©rez', 'Encargado de DepÃ³sito', 'SÃ­'],
    ['STAFF-002', 'Dra. MarÃ­a LÃ³pez', 'Veterinaria Principal', 'SÃ­'],
    ['STAFF-003', 'Ana GarcÃ­a', 'Recepcionista', 'SÃ­'],
    ['STAFF-004', 'Dr. Carlos Ruiz', 'Veterinario', 'SÃ­'],
    ['STAFF-005', 'Laura MartÃ­nez', 'Auxiliar Veterinaria', 'SÃ­'],
    ['STAFF-006', 'Pedro GÃ³mez', 'Asistente de Tienda', 'No'],
  ]

  // Combine into rows with empty separator column (E)
  // Pad to equal length for clean layout
  const maxRows = Math.max(ubicacionesData.length, responsablesData.length)
  const configData: (string | number)[][] = []

  for (let i = 0; i < maxRows; i++) {
    const ubic = ubicacionesData[i] || ['', '', '', '']
    const resp = responsablesData[i] || ['', '', '', '']
    configData.push([
      ubic[0],
      ubic[1],
      ubic[2],
      ubic[3],
      '', // Empty separator column E
      resp[0],
      resp[1],
      resp[2],
      resp[3],
    ])
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ”§ Datos - Helper sheet with FILTER formulas for dropdowns (7 columns)
  // A-CategorÃ­as, B-Marcas, C-Proveedores, D-Productos CatÃ¡logo, E-Mis Productos, F-Ubicaciones, G-Responsables
  // Uses explicit ranges to avoid full column performance issues
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  console.log('  ğŸ”§ Datos (listas para dropdowns)...')
  const datosFormulas = [
    [
      // A: CategorÃ­as activas - nombres (Nombre is column D, Activo is column J)
      '=IFERROR(SORT(FILTER(\'ğŸ“‚ CategorÃ­as\'!$D$2:$D$500, \'ğŸ“‚ CategorÃ­as\'!$J$2:$J$500="SÃ­")),"")',
      // B: Marcas activas (Activo is column O)
      '=IFERROR(SORT(FILTER(\'ğŸ·ï¸ Marcas\'!$B$2:$B$100, \'ğŸ·ï¸ Marcas\'!$O$2:$O$100="SÃ­")),"")',
      // C: Proveedores activos (Activo is column X)
      '=IFERROR(SORT(FILTER(\'ğŸ­ Proveedores\'!$B$2:$B$100, \'ğŸ­ Proveedores\'!$X$2:$X$100="SÃ­")),"")',
      // D: Productos del CatÃ¡logo activos (Activo is column O)
      '=IFERROR(SORT(FILTER(\'ğŸ†• Productos\'!$B$2:$B$2100, \'ğŸ†• Productos\'!$O$2:$O$2100="SÃ­")),"")',
      // E: Mis Productos activos (Activo is now column E)
      '=IFERROR(SORT(FILTER(\'ğŸ“‹ Mis Productos\'!$A$2:$A$501, \'ğŸ“‹ Mis Productos\'!$E$2:$E$501="SÃ­")),"")',
      // F: Ubicaciones activas - NEW: from column B where A starts with DEP- and D = SÃ­
      '=IFERROR(FILTER(\'âš™ï¸ ConfiguraciÃ³n\'!$B$2:$B$50, LEFT(\'âš™ï¸ ConfiguraciÃ³n\'!$A$2:$A$50,4)="DEP-", \'âš™ï¸ ConfiguraciÃ³n\'!$D$2:$D$50="SÃ­"),"")',
      // G: Responsables activos - NEW: from column G where F starts with STAFF- and I = SÃ­
      '=IFERROR(FILTER(\'âš™ï¸ ConfiguraciÃ³n\'!$G$2:$G$50, LEFT(\'âš™ï¸ ConfiguraciÃ³n\'!$F$2:$F$50,6)="STAFF-", \'âš™ï¸ ConfiguraciÃ³n\'!$I$2:$I$50="SÃ­"),"")',
    ],
  ]

  // Batch write Config and Datos in a single API call
  await batchUpdateValues(spreadsheetId, [
    { range: `'âš™ï¸ ConfiguraciÃ³n'!A2:I${configData.length + 1}`, values: configData },
    { range: "'ğŸ”§ Datos'!A2:G2", values: datosFormulas },
  ])

  console.log('\n  âœ… Sample data added from JSON files\n')
}
